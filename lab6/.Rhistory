setwd("~/dev/programming_for_data_science_23BDS1172/lab6")
source("~/dev/programming_for_data_science_23BDS1172/lab6/analysis.R")
install.packages("dplyr")
install.packages("ggplot2")
install.packages("lubridate", "mice", "VIM")
install.packages(c("lubridate", "mice", "VIM"))
source("~/dev/programming_for_data_science_23BDS1172/lab6/analysis.R")
ggplot(data_mice, aes(x = ProductCategory, y = Price * Quantity, fill = ProductCategory)) +
geom_bar(stat = "summary", fun = "sum") +
labs(title = "Total Sales per Product Category", y = "Total Sales", x = "Product Category")
# b) Line chart of sales trend over time
sales_trend <- data_mice %>%
mutate(Month = floor_date(as.Date(PurchaseDate), "month")) %>%
group_by(Month) %>%
summarise(MonthlySales = sum(Price * Quantity, na.rm = TRUE))
ggplot(sales_trend, aes(x = Month, y = MonthlySales)) +
geom_line(color = "blue") +
geom_point() +
labs(title = "Monthly Sales Trend", x = "Month", y = "Sales")
# c) Pie chart for payment mode distribution
payment_data <- data_mice %>%
group_by(PaymentMode) %>%
summarise(Count = n())
ggplot(payment_data, aes(x = "", y = Count, fill = PaymentMode)) +
geom_col(width = 1) +
coord_polar("y") +
labs(title = "Payment Mode Distribution")
# a) Bar chart of product category sales
ggplot(data_mice, aes(x = ProductCategory, y = Price * Quantity, fill = ProductCategory)) +
geom_bar(stat = "summary", fun = "sum") +
labs(title = "Total Sales per Product Category", y = "Total Sales", x = "Product Category")
# b) Line chart of sales trend over time
sales_trend <- data_mice %>%
mutate(Month = floor_date(as.Date(PurchaseDate), "month")) %>%
group_by(Month) %>%
summarise(MonthlySales = sum(Price * Quantity, na.rm = TRUE))
ggplot(sales_trend, aes(x = Month, y = MonthlySales)) +
geom_line(color = "blue") +
geom_point() +
labs(title = "Monthly Sales Trend", x = "Month", y = "Sales")
# a) Total sales per product category
data_mice %>%
group_by(ProductCategory) %>%
summarise(TotalSales = sum(Price * Quantity, na.rm = TRUE))
# b) Average spending per customer
data_mice %>%
group_by(CustomerID) %>%
summarise(AvgSpending = mean(Price * Quantity, na.rm = TRUE)) %>%
head(10) # show first 10 customers
# c) Trend of sales over time (monthly)
data_mice %>%
mutate(Month = floor_date(as.Date(PurchaseDate), "month")) %>%
group_by(Month) %>%
summarise(MonthlySales = sum(Price * Quantity, na.rm = TRUE))
# d) Payment mode preference
table(data_mice$PaymentMode)
data_removed <- na.omit(data)
# Method 2: Mean/Median/Mode Imputation
data_imputed <- data
data_imputed$Age[is.na(data_imputed$Age)] <- mean(data$Age, na.rm = TRUE)
data_imputed$Quantity[is.na(data_imputed$Quantity)] <- median(data$Quantity, na.rm = TRUE)
mode_gender <- names(sort(table(data$Gender), decreasing = TRUE))[1]
data_imputed$Gender[is.na(data_imputed$Gender)] <- mode_gender
# Method 3: Predictive Imputation (using mice)
mice_data <- mice(data, m = 1, maxit = 5, method = 'pmm', seed = 123)
data_mice <- complete(mice_data)
# a) Total sales per product category
data_mice %>%
group_by(ProductCategory) %>%
summarise(TotalSales = sum(Price * Quantity, na.rm = TRUE))
# b) Average spending per customer
data_mice %>%
group_by(CustomerID) %>%
summarise(AvgSpending = mean(Price * Quantity, na.rm = TRUE)) %>%
head(10) # show first 10 customers
# c) Trend of sales over time (monthly)
data_mice %>%
mutate(Month = floor_date(as.Date(PurchaseDate), "month")) %>%
group_by(Month) %>%
summarise(MonthlySales = sum(Price * Quantity, na.rm = TRUE))
# d) Payment mode preference
table(data_mice$PaymentMode)
